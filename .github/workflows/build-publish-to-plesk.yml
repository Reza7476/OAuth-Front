name: Build and deploy to plesk      
on:
 push:
  branches:
   - master
jobs:
 build-and-deploy:
  runs-on: ubuntu-latest
  steps:
  - name: Checkout code
    uses: actions/checkout@v3
  
  - name: setup .Net Core
    uses: actions/setup-dotnet@v3
    with:
     dotnet-version: '8.0.x'
  - name: restore dependencies
    run: dotnet restore
  
  - name: Build project 
    run: dotnet build --configuration Release --no-restore

  - name: publish  project
    run: dotnet publish --configuration Release --no-restore --output ./publish

  - name: Deploy to production via FTP
    uses: SamKirKland/FTP-Deploy-Action@4.3.0
    with:
     server: ${{secrets.FTP_HOST}}
     username: ${{secrets.FTP_USERNAME}}
     password: $${{secrets.FTP_PASSWORD}}
     local-dir: ./publish
